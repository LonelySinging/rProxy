## select的使用总结

+ select不会自动取消掉无效的套接字

  > 虽然 epoll 会自动取消掉被关闭的套接字，但是select并不会。如果不及时去掉的话，会出现10038错误，告诉你对一个不是套接字的对象做了套接字的操作

+ select的列表参数每次都需要重新赋值

  > 我一直以为是类似于epoll那样，把总的列表赋值给他就行了。结果他会直接修改参数，导致select一次之后有些被放弃监听了。所以需要自己维护一个所有套接字的集合

+ select只能轮询64个套接字

  > 本来我以为作为客户端的话已经够用了，结果没想到还是不够啊，打开几个网页之后就超过了64个。于是修改了上限到1024，不过感觉工作的不是很畅快。
  >
  > 因为是单线程的问题，所以没有锁的问题。也不应该是卡在哪里了，不太明白是为什么卡住了。不过太多的控制台输出也确实会影响效率
  >
  > 如果是因为性能卡顿的话，也许后面是用到线程池呢。。。虽然开发了线程池，但是一直没用。。。完全想不到这个应用哪里会需要线程池。好像只是一些简单的字符串处理。




## Tips

+ 迭代器的使用

  > 虽然这个不算是select的内容，但是一般select会和map一起使用。在清理的时候需要注意迭代器失效的问题。比如这次就在注册的回调函数中取消注册了map中的元素导致迭代器失效出错了。不过最后换了写法就没有这个问题了
  >
  > 另外，如果是想要删除所有元素的话，直接使用clear是个好的选择，不用担心迭代器失效的问题。如果需要在ereas之前做什么工作的话，那就对每个元素先做完，再clear

+ 延时删除的使用

  > 如果在一个循环中调用了对象中的方法，而这个方法中的某种行为会导致后面的循环变量出现问题，那么就可以通过在对象中设计一个删除标志的方式实现延迟删除。这样就不会出现删除了后面的对象导致后面的循环出错的情况。
  
+ 如果在头文件中使用了`static`的成员变量，那么一定要记得在`cpp`中定义以申请内存，否则将会出现找不到符号的问题。

+ 如果一个类中的成员是静态的，并且写的代码是多线程程序，那么一定记得考虑是不是安全的。

